extends layout

block content
  div.container
    h3.posr.text-center= '增加站点'
      a.posa.back.btn.btn-link(href='/list')= '返回列表'
    hr
    form(action='/poststate' method='post' enctype="multipart/form-data")
      input(type='hidden' name='stateid' id='stateid' value=state.id)
      div.form-group
        label(for='areaname')= '站点所属区域'
        input.form-control#areaname(type='text' readonly value=state.areaName required name='areaname' placeholder='北京大区/北京一区')
      div.form-group
        label(for='statename')= '站点名称'
        input.form-control#statename(type='text' readonly value=state.stateName required name='statename' placeholder='上地站')
      div.form-group
        case state.stateImg
          when null
            label.file(for='stateimg')= '站点图片'
              img#preview.img-responsive
              input.form-control#stateimg(type='file' required name='stateimg' accept="image/*")
              span#filebtn.filebtn.form-control= '选择站点图片'
          default
            label.file(for='stateimg')= '站点图片(要换一张请点击图片)'
              img#preview.img-responsive(src=state.stateImg)
              input.form-control#stateimg(type='file' required name='stateimg' accept="image/*")
              span.hide#filebtn.filebtn.form-control= '选择站点图片'
      div.form-group
        label(for='statedescription')= '站点描述'
        case state.stateDescription
          when null
            textarea.form-control#statedescription(name='statedescription' required rows='6')
          default
            textarea.form-control#statedescription(name='statedescription' required rows='6')= state.stateDescription
      div.form-group
        button.btn.btn-primary.btn-block.btn-lg= '增加'
  script(type='text/javascript').
    function getObjectURL(file) {
      var url = null;
      if (window.createObjectURL != undefined) {
        url = window.createObjectURL(file);
      } else if (window.URL != undefined) {
        url = window.URL.createObjectURL(file);
      } else if (window.webkitURL != undefined) {
        url = window.webkitURL.createObjectURL(file);
      }
      return url;
    };
    $('#stateimg').on('change', function(e) {
      var files = this.files[0];
      $('#filebtn').html(files.name).addClass('black');
      console.log(getObjectURL(files));
      $('#preview').attr('src', getObjectURL(files));
      $('#filebtn').addClass('hide');
    });